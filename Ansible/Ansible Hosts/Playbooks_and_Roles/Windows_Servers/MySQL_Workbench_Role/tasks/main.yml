
- name: Download .NET Framework 4.0 installer if it doesn't exist
  win_shell: |
    $installerPath = "C:\\Temp\\dotnet-framework-4.0.exe"
    if (-Not (Test-Path $installerPath)) {
        Invoke-WebRequest -Uri "https://dotnet.microsoft.com/download/dotnet-framework/net40" -OutFile $installerPath
    }

- name: Install .NET Framework 4.0
  win_shell: |
    Start-Process -FilePath "C:\\Temp\\dotnet-framework-4.0.exe" -ArgumentList "/q" -Wait

- name: Install Chocolatey
  win_chocolatey:
    name: chocolatey
    state: present



- name: Install .NET Framework 4.5.2
  win_chocolatey:
    name: dotnet4.5.2
    state: present

- name: Install Microsoft Visual C++ Redistributable for Visual Studio 2015-2022
  win_chocolatey:
    name: vcredist140
    version: '14.38.33135'
    source: https://community.chocolatey.org/api/v2/
    state: present

- name: Reboot the system
  win_reboot:
    reboot_timeout: 200
    
